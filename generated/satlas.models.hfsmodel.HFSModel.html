<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>satlas.models.hfsmodel.HFSModel &mdash; SATLAS 0.1.0b35 documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.0b35',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SATLAS 0.1.0b35 documentation" href="../index.html" >
    <link rel="up" title="API reference" href="../api.html" >
    <link rel="next" title="satlas.models.transformmodel.TransformHFSModel" href="satlas.models.transformmodel.TransformHFSModel.html" >
    <link rel="prev" title="satlas.models.models.PolynomialModel" href="satlas.models.models.PolynomialModel.html" > 
  </head>
  <body>

  <div class="container">
    <div class="header">
    </div>
  </div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
	
        <li class="active"><a href="../index.html">SATLAS 0.1.0b35 documentation</a></li>
	
          <li class="active"><a href="../api.html" accesskey="U">API reference</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="satlas.models.transformmodel.TransformHFSModel.html" title="satlas.models.transformmodel.TransformHFSModel"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="satlas.models.models.PolynomialModel.html" title="satlas.models.models.PolynomialModel"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="satlas-models-hfsmodel-hfsmodel">
<h1>satlas.models.hfsmodel.HFSModel<a class="headerlink" href="#satlas-models-hfsmodel-hfsmodel" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="satlas.models.hfsmodel.HFSModel">
<em class="property">class </em><code class="descclassname">satlas.models.hfsmodel.</code><code class="descname">HFSModel</code><span class="sig-paren">(</span><em>I, J, ABC, centroid, fwhm=[50.0, 50.0], scale=1.0, background_params=[0.001], shape='voigt', use_racah=False, use_saturation=False, saturation=0.001, shared_fwhm=True, sidepeak_params={'Offset': 0, 'N': 0, 'Poisson': 0.68}, crystalballparams={'Taillocation': 1, 'Tailamplitude': 1}, pseudovoigtparams={'Eta': 0.5, 'A': 0}, asymmetryparams={'a': 0}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/satlas/models/hfsmodel.html#HFSModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.models.hfsmodel.HFSModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a HFS spectrum, consisting of different
peaks described by a certain profile. The number of peaks is governed by
the nuclear spin and the atomic spins of the levels.</p>
<dl class="method">
<dt id="satlas.models.hfsmodel.HFSModel.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>I, J, ABC, centroid, fwhm=[50.0, 50.0], scale=1.0, background_params=[0.001], shape='voigt', use_racah=False, use_saturation=False, saturation=0.001, shared_fwhm=True, sidepeak_params={'Offset': 0, 'N': 0, 'Poisson': 0.68}, crystalballparams={'Taillocation': 1, 'Tailamplitude': 1}, pseudovoigtparams={'Eta': 0.5, 'A': 0}, asymmetryparams={'a': 0}</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/satlas/models/hfsmodel.html#HFSModel.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.models.hfsmodel.HFSModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the HFS with the given atomic and nuclear information.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>I</strong> (<em>float</em>) &#8211; The nuclear spin.</li>
<li><strong>J</strong> (<em>list of 2 floats</em>) &#8211; The spins of the fine structure levels.</li>
<li><strong>ABC</strong> (<em>list of 6 floats</em>) &#8211; The hyperfine structure constants A, B and C for ground- and excited
fine level. The list should be given as [A <sub>lower</sub>,
A <sub>upper</sub>, B <sub>lower</sub>, B <sub>upper</sub>, C <sub>upper</sub>,
C <sub>lower</sub>].</li>
<li><strong>centroid</strong> (<em>float</em>) &#8211; Centroid of the spectrum.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><ul class="first last">
<li><p class="first"><strong>fwhm</strong> (<em>float or list of 2 floats, optional</em>) &#8211; Depending on the used shape, the FWHM is defined by one or two floats.
Defaults to [50.0, 50.0]</p>
</li>
<li><p class="first"><strong>scale</strong> (<em>float, optional</em>) &#8211; Sets the strength of the spectrum, defaults to 1.0. Comparable to the
amplitude of the spectrum.</p>
</li>
<li><p class="first"><strong>background_params</strong> (<em>list of float, optional</em>) &#8211; Sets the coefficients of the polynomial background to the given values.
Order of polynomial is equal to the number of parameters given minus one.
Highest order coefficient is the first element, etc.</p>
</li>
<li><p class="first"><strong>shape</strong> (<em>string, optional</em>) &#8211; Sets the transition shape. String is converted to lowercase. For
possible values, see <em>HFSModel__shapes__</em>.keys()`.
Defaults to Voigt if an incorrect value is supplied.</p>
</li>
<li><p class="first"><strong>use_racah</strong> (<em>boolean, optional</em>) &#8211; If True, fixes the relative peak intensities to the Racah intensities.
Otherwise, gives them equal intensities and allows them to vary during
fitting.</p>
</li>
<li><p class="first"><strong>use_saturation</strong> (<em>boolean, optional</em>) &#8211; If True, uses the saturation parameter to calculate relative intensities.</p>
</li>
<li><p class="first"><strong>saturation</strong> (<em>float, optional</em>) &#8211; If different than 0, calculate the saturation effect on the intensity of
transition intensity. This is done by an exponential transition between
Racah intensities and the saturated intensities.</p>
</li>
<li><p class="first"><strong>shared_fwhm</strong> (<em>boolean, optional</em>) &#8211; If True, the same FWHM is used for all peaks. Otherwise, give them all
the same initial FWHM and let them vary during the fitting.</p>
</li>
<li><p class="first"><strong>sidepeak_params</strong> (<em>dict</em>) &#8211; A dictionary with the following keys and values:</p>
<dl class="docutils">
<dt>n: int</dt>
<dd><p class="first last">Sets the number of sidepeaks that are present in the spectrum.
Defaults to 0.</p>
</dd>
<dt>poisson: float</dt>
<dd><p class="first last">Sets the relative intensity of the first side peak. The intensity of the
other sidepeaks is calculated from the Poisson-factor.</p>
</dd>
<dt>offset: float</dt>
<dd><p class="first last">Sets the distance (in MHz) of each sidepeak in the spectrum.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>crystalballparams</strong> (<em>dict</em>) &#8211; A dictionary with the following keys and values:</p>
<dl class="docutils">
<dt>tailamp: float</dt>
<dd><p class="first last">Sets the relative amplitude of the tail for the Crystalball shape function.</p>
</dd>
<dt>tailloc: float</dt>
<dd><p class="first last">Sets the location of the tail for the Crystalball shape function.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>pseudovoigtparams</strong> (<em>dict</em>) &#8211; A dictionary with the following keys and values:</p>
<dl class="docutils">
<dt>Eta: float between 0 and 1</dt>
<dd><p class="first last">Describes the mixing percentage of the Gaussian and Lorentzian shapes</p>
</dd>
<dt>A: float</dt>
<dd><p class="first last">Describes the asymmetry of the peak.</p>
</dd>
</dl>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>The list of parameter keys is:</dt>
<dd><ul class="first last simple">
<li><em>FWHM</em> (only for profiles with one float for the FWHM)</li>
<li><em>FWHMG</em> (only for profiles with two floats for the FWHM)</li>
<li><em>FWHML</em> (only for profiles with two floats for the FWHM)</li>
<li><em>Al</em></li>
<li><em>Au</em></li>
<li><em>Bl</em></li>
<li><em>Bu</em></li>
<li><em>Cl</em></li>
<li><em>Cu</em></li>
<li><em>Centroid</em></li>
<li><em>Background</em></li>
<li><em>Poisson</em> (only if the attribute <em>n</em> is greater than 0)</li>
<li><em>Offset</em> (only if the attribute <em>n</em> is greater than 0)</li>
<li><em>Amp</em> (with the correct labeling of the transition)</li>
<li><em>scale</em></li>
</ul>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="satlas.models.hfsmodel.HFSModel.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/satlas/models/hfsmodel.html#HFSModel.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#satlas.models.hfsmodel.HFSModel.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the response for frequency <em>x</em> (in MHz) of the spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> (<em>float</em><em> or </em><em>array_like</em>) &#8211; Frequency in MHz</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Response of the spectrum for each value of <em>x</em>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float or NumPy array</td>
</tr>
</tbody>
</table>
</dd></dl>

<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#satlas.models.hfsmodel.HFSModel.__init__" title="satlas.models.hfsmodel.HFSModel.__init__"><code class="xref py py-obj docutils literal"><span class="pre">__init__</span></code></a>(I,&nbsp;J,&nbsp;ABC,&nbsp;centroid[,&nbsp;fwhm,&nbsp;scale,&nbsp;...])</td>
<td>Builds the HFS with the given atomic and nuclear information.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#satlas.models.hfsmodel.HFSModel.__call__" title="satlas.models.hfsmodel.HFSModel.__call__"><code class="xref py py-obj docutils literal"><span class="pre">__call__</span></code></a>(x)</td>
<td>Get the response for frequency <em>x</em> (in MHz) of the spectrum.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">display_chisquare_fit</span></code>([scaled])</td>
<td>Display all relevent info of the least-squares fitting routine, if this has been performed.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">display_mle_fit</span></code>([scaled])</td>
<td>Give a readable overview of the result of the MLE fitting routine.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">fix_ratio</span></code>(value[,&nbsp;target,&nbsp;parameter])</td>
<td>Fixes the ratio for a given hyperfine parameter to the given value.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">get_chisquare_mapping</span></code>()</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">get_lnprior_mapping</span></code>(params)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">get_result</span></code>([selection])</td>
<td>Return the variable names, values and estimated error bars for the parameters as seperate lists.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">get_result_dict</span></code>([method,&nbsp;scaled])</td>
<td>Returns the fitted parameters in a dictionary of the form {name: [value, uncertainty]}.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">get_result_frame</span></code>([method,&nbsp;selected,&nbsp;bounds,&nbsp;...])</td>
<td>Returns the data from the fit in a pandas DataFrame.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">plot</span></code>([x,&nbsp;y,&nbsp;yerr,&nbsp;no_of_points,&nbsp;ax,&nbsp;show,&nbsp;...])</td>
<td>Plot the hfs, possibly on top of experimental data.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">plot_scheme</span></code>([show,&nbsp;upper_color,&nbsp;...])</td>
<td>Create a figure where both the splitting of the upper and lower state is drawn, and the hfs associated with this.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">plot_spectroscopic</span></code>(\*\*kwargs)</td>
<td>Plots the hfs on top of experimental data with errorbar given by the square root of the data.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">save</span></code>(path)</td>
<td>Saves the current spectrum, including the results of the fitting and the parameters, to the specified file.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">seperate_response</span></code>(x)</td>
<td>Wraps the output of the <a class="reference internal" href="#satlas.models.hfsmodel.HFSModel.__call__" title="satlas.models.hfsmodel.HFSModel.__call__"><code class="xref py py-meth docutils literal"><span class="pre">__call__</span></code></a> in a list, for ease of coding in the fitting routines.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">set_boundaries</span></code>(boundaryDict)</td>
<td>Sets the boundaries of the fitparameters as supplied in the dictionary.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">set_chisquare_mapping</span></code>(mappingDict)</td>
<td>Sets the prior mapping for the different parameters.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">set_expr</span></code>(exprDict)</td>
<td>Sets the expression of the selected parameters to the given expressions.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">set_literature_values</span></code>(literatureDict)</td>
<td>Sets the lnprior and chisquare mapping to handle the given literature values and uncertainties.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">set_lnprior_mapping</span></code>(mappingDict)</td>
<td>Sets the prior mapping for the different parameters.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">set_value</span></code>(valueDict)</td>
<td>Sets the value of the given parameters to the given values.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">set_variation</span></code>(varyDict)</td>
<td>Sets the variation of the fitparameters as supplied in the dictionary.</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">ftof</span></code></td>
<td>List of transition labels, of the form <em>Flow__Fhigh</em> (half-integers have an underscore instead of a division sign), same ordering as given by the attribute <code class="xref py py-attr docutils literal"><span class="pre">locations</span></code>.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">locations</span></code></td>
<td>Contains the locations of the peaks.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">params</span></code></td>
<td>Instance of lmfit.Parameters object characterizing the shape of the HFS.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">HFSModel.roi</span></code></td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">use_racah</span></code></td>
<td>Boolean to set the behaviour to Racah intensities (True) or to individual amplitudes (False).</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">use_saturation</span></code></td>
<td>Boolean to set the behaviour to the saturation model (True) or not (False).</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="satlas.models.models.PolynomialModel.html"
                        title="previous chapter">satlas.models.models.PolynomialModel</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="satlas.models.transformmodel.TransformHFSModel.html"
                        title="next chapter">satlas.models.transformmodel.TransformHFSModel</a></p>
  <h3>This Page</h3>
  <div>
    <a href="../_sources/generated/satlas.models.hfsmodel.HFSModel.rst.txt"
       rel="nofollow">Show Source</a>
  </div>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2015, Wouter Gins.
      </li>
      <li>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.5.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>